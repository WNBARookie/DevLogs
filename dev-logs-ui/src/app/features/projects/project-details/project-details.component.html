<p-toast></p-toast>
<p-confirmdialog></p-confirmdialog>

<div class="flex align-items-center justify-content-between mx-4">
    @if(project$ | async; as project) {
    <h2>{{ project.title }}</h2>
    }
    <div class="flex">
        <p-button icon="pi pi-plus" [rounded]="true" (click)="showItemDialog(null)" class="mr-3" />
        <p-button icon="pi pi-lightbulb" [rounded]="true" [text]="true" severity="warn" (click)="generateSummary()" />
    </div>
</div>


@if(summaryGenerated){
<p-card [style]="{ backgroundColor: 'rgba(0,0,0,0.1)', margin: '0 1.5rem' }">
    <ng-template #title> Summary of project:</ng-template>
    <div class="flex align-items-center gap-2">
        <p-button icon="pi pi-lightbulb" [rounded]="true" [text]="true" severity="warn" size="large" />

        <p>{{summary}}</p>
    </div>

</p-card>
}


<p-accordion [multiple]="true" class="" [style]="{ backgroundColor: 'rgba(0,0,0,0.1)' }">
    @for (item of items$ | async; track item; let idx = $index) {
    <p-accordion-panel [value]=" idx" class="px-2">
        <p-accordion-header>
            <div class="flex align-items-center">
                <span>{{ item.title }}</span>
                <p-menu #menu [model]="menuItems" [popup]="true" appendTo="body" />
                <p-button (click)="toggleMenu(menu, $event, item); $event.stopPropagation()" icon="pi pi-ellipsis-v"
                    [text]="true" severity="secondary" />
            </div>
        </p-accordion-header>
        <p-accordion-content>
            <div class="">
                <small class="font-semibold">Description:</small>
                <p>{{item.description}}</p>
                <!-- <p-divider /> -->

                <small class="font-semibold">Skills Applied:</small>
                <p>{{item.skillsApplied}}</p>
                <!-- <p-divider /> -->

                <small class="font-semibold">Lessons Learned:</small>
                <p>{{item.lessonsLearned}}</p>
                <!-- <p-divider /> -->

                <small class="font-semibold">Date Completed:</small>
                <p>{{item.dateCompleted | date : "LL-dd-yyyy" }}</p>

            </div>
        </p-accordion-content>
    </p-accordion-panel>
    } @empty {
    <div>There are no items.</div>
    }
</p-accordion>


<app-item-form *ngIf="displayItemDialog" [currentItem]="currentItem" [displayItemDialog]="displayItemDialog"
    (itemDialogStatus)="showItemDialogToggle($event)" (refreshData)="refreshData($event)" [projectId]="projectId">
</app-item-form>